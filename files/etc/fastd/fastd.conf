# sources: https://projects.universe-factory.net/projects/fastd/wiki
# docs: http://fastd.readthedocs.org/en/v16/

# Log warnings and errors to stderr
log level warn;

# Log everything to syslog
log to syslog level debug;

# Set the interface name
mode tap;
interface "fastd";

# Support salsa2012+umac and null methods, prefer salsa2012+umac
method "null+salsa2012+umac";

# Bind to a fixed port, IPv4 only
#bind any:5001;
bind any:5001 interface "eth0";

# Public key used by peer
# Secret key generated by `fastd --generate-key`
#2014-12-30 01:21:07 +0100 --- Info: Reading 32 bytes from /dev/random...
#Secret: 38188b385247006c9cf2846caaea3cca5b77a63325f3a62ba8e77cc2c03e3b6f
#Public: 34b940f9fdfb6b05e29944e3d9bf886a310902ab6090387aa79ecbed2cc34c2b
secret "38188b385247006c9cf2846caaea3cca5b77a63325f3a62ba8e77cc2c03e3b6f";

# Set the interface MTU for TAP mode with xsalsa20/aes128 over IPv4 with a base MTU of 1492 (PPPoE)
# (see MTU selection documentation)
mtu 1426;


# Include peers from the directory 'peers'
include peers from "peers";

#bei bridges:
# wenn bridges auf beiden seiten verwendet werden, dann befinden sich irgendwann alle clients im gleichen
# ethernet segment. es ist dann nicht kontrollierbar, welche verbindung verwendet wird.
# Es funktioniert nur, wenn die server seite alle ankommenden Verbindngen in einer bridge sammelt. dann bleibt
# die 1:1 verbindung zwischen IPs bestehen. Die bridge loesst die IP zu Mac auf, welche nur ueber ein einziges interface
# direkt erreichbar ist.
# Mit bridges kann man dann fuer bmxd nur ein interface verwenden.

# fastd hat nur ein server interface und arbeitet somit wie ein bridge.
# allow only one peer (1:1 connection, da ich fuer jede verbindung ein eigenes interface brauche)
#peer limit 1


#call one script for all. first parameter is the command, second parameter is the "nickname"
on pre-up sync "/etc/fastd/cmd.sh pre-up nickname";
on up sync "/etc/fastd/cmd.sh up nickname";
on down sync "/etc/fastd/cmd.sh down nickname";
on post-down sync "/etc/fastd/cmd.sh post-down nickname";
on connect sync "/etc/fastd/cmd.sh connect nickname";
on establish sync "/etc/fastd/cmd.sh establish nickname";
on disestablish sync "/etc/fastd/cmd.sh disestablish nickname";
on verify sync "/etc/fastd/cmd.sh verify nickname";

#2014-12-29 23:41:35 +0100 --- Info: Reading 32 bytes from /dev/random...
#Secret: f053b689926bff81b1f40f353d391a0f0da3eaa76074dc407ba7bf9c3341606f
#Public: d45e5ad48b6402432094b524f58aa4e2dd8e3dee5402a712ed42a486eb5c6294
